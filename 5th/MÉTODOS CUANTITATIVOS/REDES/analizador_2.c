/*
	ANALIZADOR DE TRAMAS LLC, ARP, IP, ICMP, TCP, UDP, 
	AUTOR: VAZQUEZ MORENO MARCOS OSWALDO  2016601777
	ESCUELA SUPERIOR DE COMPUTO
	TERMINADO 4 DE DICIEMBRE DE 2018 A LAS 11:24 PM 

INSERTE TRAMAS A PLACER, Y MODIFIQUE EL ESPACIO SI EXCEDE EL LIMITE PARA QUE NO SE GENEREN WARNINGS
A SU VEZ AUMENTE EL CONTADOR DEPENDIENDO DEL TOTAL DE TRAMAS COLOCADAS EN T[][NUMERO DE CARACTERES EN LA TRAMA]

TODO PARECE FUNCIONAR, ESPEREMOS EL DIA DEL JUICIO


*/
#include <stdio.h>
#include <stdlib.h>

char * check(unsigned char *T, unsigned char inicio, unsigned char final, unsigned char protocolo); 
unsigned char contarBits(unsigned char T[], unsigned char tam); //FUNCION QUE CUENTA LOS BITS
void analiza(unsigned char T[]);//FUNCION QUE RECIBE A LA TRAMA Y AL TAMAnio Y CUENTA LOS BITS
int main() 
	
{	
		//	unsigned char T[] = {0x7B, 0x69, 0x6C, 0x20, 0x79, 0x20, 0x61, 0x20, 0x64, 0x75, 0x20, 0x76, 0x65, 0x6E, 0x74, 0xCF, 0x9A, 0xA0, 0x00, 0x24}; //TRAMA 
	/*	unsigned char T[][400]=
	{ 
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x03,0xf0,0xf0,
		 0x7f,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x43,0x05,0x90,0x6d}, //trama1
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x03,0xf0,0xf1,
		 0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x54,0x90,0x6d}, //trama2
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf0,
		 0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x41,0xa3,0x90,0x6d}, //trama3
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xf2,0x90,0x6d}, //trama4
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
		 0x00,0x01,0x0e,0x00,0xff,0xef,0x19,0x8f,0xbc,0x05,0x7f,0x00,0x23,0x00,0x7f,0x23,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x41,0x91,0x6d}, //trama5
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x12,0xf0,0xf0,
		 0x00,0x03,0x0e,0x00,0xff,0xef,0x17,0x81,0xbc,0x05,0x23,0x00,0x7f,0x00,0x23,0x7f,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x90,0x91,0x6d}, //trama6
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xdf,0x91,0x6d}, //trama7
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
		 0x01,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0xac,0x92,0x6d}, //trama8
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0xac,0xf0,0xf0,
		 0x02,0x02,0x0e,0x00,0xff,0xef,0x16,0x04,0x00,0x00,0x00,0x00,0x28,0x00,0x7f,0x23,
		 0xff,0x53,0x4d,0x42,0x72,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x82,0x09,
		 0x00,0x77,0x00,0x02,0x50,0x43,0x20,0x4e,0x45,0x54,0x57,0x4f,0x52,0x4b,0x20,0x50,
		 0x52,0x4f,0x47,0x52,0x41,0x4d,0x20,0x31,0x2e,0x30,0x00,0x02,0x4d,0x49,0x43,0x52,
		 0x4f,0x53,0x4f,0x46,0x54,0x20,0x4e,0x45,0x54,0x57,0x4f,0x52,0x4b,0x53,0x20,0x33,
		 0x2e,0x30,0x00,0x02,0x44,0x4f,0x53,0x20,0x4c,0x4d,0x31,0x2e,0x32,0x58,0x30,0x30,
		 0x32,0x00,0x02,0x44,0x4f,0x53,0x20,0x4c,0x41,0x4e,0x4d,0x41,0x4e,0x32,0x2e,0x31,
		 0x00,0x02,0x57,0x69,0x6e,0x64,0x6f,0x77,0x73,0x20,0x66,0x6f,0x72,0x20,0x57,0x6f,
		 0x72,0x6b,0x67,0x72,0x6f,0x75,0x70,0x73,0x20,0x33,0x2e,0x31,0x61,0x00,0x02,0x4e,
		 0x54,0x20,0x4c,0x4d,0x20,0x30,0x2e,0x31,0x32,0x00,0x00,0xfb,0x92,0x6d,0x86,0xdf}, //trama9
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7b,0x93,0x6d}, //trama10
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x5f,0xf0,0xf0,
		 0x02,0x04,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x23,0x7f,
		 0xff,0x53,0x4d,0x42,0x72,0x00,0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x82,0x09,
		 0x11,0x05,0x00,0x02,0x02,0x00,0x01,0x00,0x68,0x0b,0x00,0x00,0x00,0x00,0x01,0x00,
		 0x7f,0x07,0x00,0x80,0x03,0x02,0x00,0x00,0x00,0xe5,0xfe,0x29,0x25,0x7c,0xc2,0x01,
		 0x2c,0x01,0x08,0x08,0x00,0x7f,0x07,0x00,0x80,0x32,0x3e,0xb9,0x3d,0x00,0xca,0x93}, //trama11
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
		 0x01,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7c,0x94,0x6d}, //trama12
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x91,0xf0,0xf0,
		 0x04,0x04,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x7f,0x23,
		 0xff,0x53,0x4d,0x42,0x73,0x00,0x00,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x82,0x09,
		 0x0d,0x75,0x00,0x5d,0x00,0x68,0x0b,0x02,0x00,0x00,0x00,0x7f,0x07,0x00,0x80,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x45,
		 0x53,0x43,0x4f,0x4d,0x00,0x57,0x69,0x6e,0x64,0x6f,0x77,0x73,0x20,0x34,0x2e,0x30,
		 0x00,0x57,0x69,0x6e,0x64,0x6f,0x77,0x73,0x20,0x34,0x2e,0x30,0x00,0x04,0xff,0x00,
		 0x00,0x00,0x02,0x00,0x02,0x00,0x17,0x00,0x20,0x00,0x5c,0x5c,0x50,0x52,0x4f,0x47,
		 0x59,0x44,0x45,0x53,0x41,0x5c,0x49,0x50,0x43,0x24,0x00,0x49,0x50,0x43,0x00,0x00}, //trama13
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x32,0x95,0x6d}, //trama14
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x46,0xf0,0xf0,
		 0x04,0x06,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x23,0x7f,
		 0xff,0x53,0x4d,0x42,0x73,0x00,0x00,0x00,0x00,0x90,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,0x00,0x00,0x82,0x09,
		 0x03,0x75,0x00,0x29,0x00,0x00,0x00,0x00,0x00,0x02,0xff,0x00,0x00,0x00,0x04,0x00,
		 0x49,0x50,0x43,0x00,0x00,0x81,0x95,0x6d,0x86,0xcb,0x94,0x6d,0x86,0x0d,0x09,0x0e}, //trama15
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
		 0x01,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x96,0x6d}, //trama16
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x7e,0xf0,0xf0,
		 0x06,0x06,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x7f,0x23,
		 0xff,0x53,0x4d,0x42,0x25,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,0x00,0x00,0x82,0x0a,
		 0x0e,0x20,0x00,0x00,0x00,0x08,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x88,0x13,0x00,
		 0x00,0x00,0x00,0x20,0x00,0x4c,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x2d,0x00,0x5c,
		 0x50,0x49,0x50,0x45,0x5c,0x4c,0x41,0x4e,0x4d,0x41,0x4e,0x00,0x68,0x00,0x57,0x72,
		 0x4c,0x65,0x68,0x44,0x7a,0x00,0x42,0x31,0x36,0x42,0x42,0x44,0x7a,0x00,0x01,0x00,
		 0x00,0x10,0xff,0xff,0xff,0xff,0x45,0x53,0x43,0x4f,0x4d,0x00,0x00,0x6f,0x96,0x6d}, //trama17
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xbe,0x96,0x6d}, //trama18
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
		 0x01,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x5d,0x97,0x6d}, //trama19
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x7e,0xf0,0xf0,
		 0x08,0x08,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x7f,0x23,
		 0xff,0x53,0x4d,0x42,0x25,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,0x00,0x00,0x02,0x0b,
		 0x0e,0x20,0x00,0x00,0x00,0x08,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x88,0x13,0x00,
		 0x00,0x00,0x00,0x20,0x00,0x4c,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x2d,0x00,0x5c,
		 0x50,0x49,0x50,0x45,0x5c,0x4c,0x41,0x4e,0x4d,0x41,0x4e,0x00,0x68,0x00,0x57,0x72,
		 0x4c,0x65,0x68,0x44,0x7a,0x00,0x42,0x31,0x36,0x42,0x42,0x44,0x7a,0x00,0x01,0x00,
		 0x00,0x10,0x00,0x00,0x00,0x80,0x45,0x53,0x43,0x4f,0x4d,0x00,0x00,0xac,0x97,0x6d}, //trama20
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x0a,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xfb,0x97,0x6d}, //trama21
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
		 0x01,0x0a,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x4a,0x98,0x6d}, //trama22
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
		 0x0a,0x0b,0x0e,0x00,0xff,0xef,0x14,0x00,0x00,0x00,0x28,0x00,0x00,0x00,0x7f,0x23,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x99,0x98,0x6d}, //trama23
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x0d,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x45,0x99,0x6d}, //trama24
		{0x03,0x00,0x00,0x00,0x00,0x01,0x00,0x04,0xac,0x44,0x4d,0x02,0x00,0x8b,0xf0,0xf0,
		 0x03,0x2c,0x00,0xff,0xef,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x42,0x34,0x20,
		 0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x1b,0x49,0x42,0x4d,
		 0x53,0x45,0x52,0x56,0x45,0x52,0x20,0x20,0x20,0x20,0x20,0x20,0x00,0xff,0x53,0x4d,
		 0x42,0x25,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x11,0x00,0x00,
		 0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xe8,0x03,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x06,0x00,0x56,0x00,0x03,0x00,0x01,0x00,0x01,0x00,0x02,0x00,
		 0x17,0x00,0x5c,0x4d,0x41,0x49,0x4c,0x53,0x4c,0x4f,0x54,0x5c,0x42,0x52,0x4f,0x57,
		 0x53,0x45,0x00,0x09,0x04,0x33,0x17,0x00,0x00,0x00,0x9b,0x99,0x6d,0x86,0x99,0x98}, //trama25
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x35,0xf0,0xf0,
		 0x0c,0x0a,0x0e,0x00,0xff,0xef,0x16,0x04,0x00,0x00,0x00,0x00,0x28,0x00,0x7f,0x23,
		 0xff,0x53,0x4d,0x42,0x71,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,0x00,0x00,0x01,0x50,
		 0x00,0x00,0x00,0x45,0xf1,0x99,0x6d,0x86,0x45,0x99,0x6d,0x86,0x1f,0x09,0x52,0x5b}, //trama26
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x35,0xf0,0xf0,
		 0x0a,0x0e,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x23,0x7f,
		 0xff,0x53,0x4d,0x42,0x71,0x00,0x00,0x00,0x00,0x80,0x01,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,0x00,0x00,0x01,0x50,
		 0x00,0x00,0x00,0x00,0x40,0x9a,0x6d,0x86,0x9b,0x99,0x6d,0x86,0x20,0x09,0x75,0x5b}, //trama27
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
		 0x0e,0x0d,0x0e,0x00,0xff,0xef,0x14,0x00,0x00,0x00,0x28,0x00,0x00,0x00,0x7f,0x23,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x8f,0x9a,0x6d}, //trama28
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x11,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xde,0x9a,0x6d}, //trama29
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
		 0x10,0x0d,0x0e,0x00,0xff,0xef,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7f,0x23,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x2d,0x9b,0x6d}, //trama30
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x13,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7c,0x9b,0x6d}, //trama31
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x03,0xf0,0xf0,
		 0x53,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xcb,0x9b,0x6d}, //trama32
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x03,0xf0,0xf1,
		 0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x77,0x9c,0x6d},
		 
		{0xff,0xff,0xff,0xff,0xff,0xff,0x00,0x23,0x8b,0x46,0xe9,0xad,0x08,0x06,0x00,0x04, 
		 0x08,0x00,0x06,0x04,0x00,0x01,0x00,0x23,0x8b,0x46,0xe9,0xad,0x94,0xcc,0x39,0xcb, 
		 0x00,0x00,0x00,0x00,0x00,0x00,0x94,0xcc,0x39,0xfe },						   /*Trama a */

	unsigned char T[][400] = {
		
	{0xff,0xff,0xff,0xff,0xff,0xff,0x00,0x23,0x8b,0x46,0xe9,0xad,0x08,0x06,0x00,0x04, 
		 0x08,0x00,0x06,0x04,0x00,0x01,0x00,0x23,0x8b,0x46,0xe9,0xad,0x94,0xcc,0x39,0xcb, 
		 0x00,0x00,0x00,0x00,0x00,0x00,0x94,0xcc,0x39,0xfe },						   		//trama33

		{0x00,0x23,0x8b,0x46,0xe9,0xad,0x00,0x1f,0x45,0x9d,0x1e,0xa2,0x08,0x06,0x00,0x01,  //trama34
		 0x08,0x00,0x06,0x04,0x00,0x02,0x00,0x1f,0x45,0x9d,0x1e,0xa2,0x94,0xcc,0x39,0xfe,
		 0x00,0x23,0x8b,0x46,0xe9,0xad,0x94,0xcc,0x39,0xcb,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 },
		
	{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x00, 0x45, 0x00,
		 0x00, 0x3c, 0x01, 0xb5, 0x00, 0x00, 0x3f, 0x01, 0xdb, 0xc7, 0x94, 0xcc, 0x3a, 0xe1, 0x94, 0xcc,
		 0x39, 0xcb, 0x00, 0x00, 0x51, 0x5c, 0x03, 0x00, 0x01, 0x00, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66,
		 0x67, 0x68, 0x69, 0x6a, 0x6b, 0x6c, 0x6d, 0x6e, 0x6f, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76,
		 0x77, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69}, //IP, ICMP

		 {0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x08, 0x00, 0x46, 0x00,
		 0x80, 0x42, 0x04, 0x55, 0x34, 0x11, 0x80, 0x11, 0x2c, 0x11, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc,
		 0x67, 0x02, 0x07, 0x44, 0x83, 0x89, 0x04, 0x0c, 0x00, 0x35, 0x00, 0x2e, 0x85, 0x7c, 0xe2, 0x1a,
		 0x01, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x77, 0x77, 0x77, 0x03, 0x69,
		 0x73, 0x63, 0x05, 0x65, 0x73, 0x63, 0x6f, 0x6d, 0x03, 0x69, 0x70, 0x6e, 0x02, 0x6d, 0x78, 0x00,
		 0x00, 0x1c, 0x00, 0x01}, //IP con opciones/UDP

         {0x00,0x14,0xd1,0x38,0xbe,0x00,0x18,0xe7,0x33,0x3d,0xc3,0xc3,0x08,0x00,0x45,0x00,
		  0x00,0x30,0x94,0x71,0x40,0x00,0x80,0x06,0xf9,0x8c,0xc0,0xa8,0x02,0x3c,0x4a,0x7d,
		  0x5f,0x68,0x10,0x52,0x00,0x50,0x03,0xc7,0x5a,0xa1,0x00,0x00,0x00,0x00,0x70,0x02,
		  0x40,0x00,0x67,0x4b,0x00,0x00,0x02,0x04,0x05,0xb4,0x01,0x01,0x04,0x02}, // IP, TCP con opciones

		  {0x02, 0xff, 0x53, 0xc3, 0xe9, 0xab, 0x00, 0xff, 0x66, 0x7f, 0xd4, 0x3c, 0x08, 0x00, 0x45, 0x00,
		 0x00, 0x28, 0x2d, 0x00, 0x40, 0x00, 0x80, 0x06, 0x4a, 0x7c, 0xc0, 0xa8, 0x01, 0x02, 0xc0, 0xa8,
		 0x01, 0x01, 0x04, 0x03, 0x00, 0x15, 0x00, 0x3b, 0xcf, 0x45, 0x21, 0x5d, 0x3a, 0x45, 0x50, 0x10,
		 0x22, 0x38, 0xdb, 0x0d, 0x00, 0x00}, // IP, TCP sin opciones
	
		{0x01, 0x00,0x5e,0x00,0x00,0x16,0xd8,0xcb,0x8a,0xd2, 0x84,0xaa,0x08,0x00,0x46,0x00,
		0x00,0x28,0x03, 0xcb,0x00,0x00,0x01,0x02,0x38,0x87,0x08, 0x0c, 0x00,0x5c,0xe0,0x00,
		0x00,0x16,0x94, 0x04,0x00,0x00,0x22,0x00,0xfa,0x01,0x00, 0x00, 0x00,0x01,0x03,0x00,	
		0x00,0x00,0xe0, 0x00,0x00,0xfc,0x00,0x00,0x00,0x00,0x00, 0x00},
		
		{0x02, 0xff, 0x53, 0xc3, 0xe9, 0xab, 0x00, 0xff, 0x66, 0x7f, 0xd4, 0x3c, 0x08, 0x00, 0x45, 0x00,
		 0x00, 0x30, 0x2c, 0x00, 0x40, 0x00, 0x80, 0x01, 0x4b, 0x79, 0xc0, 0xa8, 0x01, 0x02, 0xc0, 0xa8,
		 0x01, 0x01, 0x05, 0x02, 0xfa, 0xfd},																//TRAMA 36 IP / ICMP

		{0x02, 0xff, 0x53, 0xc3, 0xe9, 0xab, 0x00, 0xff, 0x66, 0x7f, 0xd4, 0x3c, 0x08, 0x00, 0x45, 0x00,
		 0x00, 0x28, 0x2d, 0x00, 0x40, 0x00, 0x80, 0x06, 0x4a, 0x7c, 0xc0, 0xa8, 0x01, 0x02, 0xc0, 0xa8,
		 0x01, 0x01, 0x04, 0x03, 0x00, 0x15, 0x00, 0x3b, 0xcf, 0x45, 0x21, 0x5d, 0x3a, 0x45, 0x50, 0x10,
		 0x22, 0x38, 0xdb, 0x0d, 0x00, 0x00},																//TRAMA 37 IP / TCP

		{0x02, 0xff, 0x53, 0xc3, 0xe9, 0xab, 0x00, 0xff, 0x66, 0x7f, 0xd4, 0x3c, 0x08, 0x00, 0x45, 0x00,
		 0x00, 0x30, 0x2c, 0x00, 0x40, 0x00, 0x80, 0x06, 0x4b, 0x74, 0xc0, 0xa8, 0x01, 0x02, 0xc0, 0xa8,
		 0x01, 0x01, 0x04, 0x03, 0x00, 0x15, 0x00, 0x3b, 0xcf, 0x44, 0x00, 0x00, 0x00, 0x00, 0x70, 0x02,
		 0x20, 0x00, 0x0c, 0x34, 0x00, 0x00, 0x02, 0x04, 0x05, 0xb4, 0x01, 0x02, 0x04, 0x02}, 				//TRAMA 38 IP / TCP con Opciones

		{0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x08, 0x00, 0x46, 0x00,
		 0x80, 0x42, 0x04, 0x55, 0x34, 0x11, 0x80, 0x11, 0x2c, 0x11, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc,
		 0x67, 0x02, 0x07, 0x44, 0x83, 0x89, 0x04, 0x0c, 0x00, 0x35, 0x00, 0x2e, 0x85, 0x7c, 0xe2, 0x1a,
		 0x01, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x77, 0x77, 0x77, 0x03, 0x69,
		 0x73, 0x63, 0x05, 0x65, 0x73, 0x63, 0x6f, 0x6d, 0x03, 0x69, 0x70, 0x6e, 0x02, 0x6d, 0x78, 0x00,
		 0x00, 0x1c, 0x00, 0x01}
		
		
	};
	
	int i=0;
	for (i=0; i<11; i++ ){
	printf("------------Trama %d-----------\n", i);
	analiza(T[i]);
	printf("\n");
	 
}
	//LO SIGUIENTE ES PRACTICAMENTE NUESTRO ACORDEON ENMICADO PASO POR PASO 
	
	//FUNCION QUE GENERA TODO EL ANALISIS
}

	void analiza(unsigned char T[]) //RECIBE EN LA LISTA SENSITIVA A TODAS Y CADA UNA DE LAS TRAMAS A ANALIZAR
{
		unsigned char supervision[][5] = { "RR", "RNR", "RES", "SREJ" }; 
		unsigned char UC [][5] = {"UI","SIM", "", "SARM", "NP","","", "SARME", "PISC","","", "SABM","","","", "SABME", "SNRM","","", "RSET","","","", "XID","","","", "SNRME"};
		unsigned char UR [][5] = {"UI","RIM", "", "SARM", };
		unsigned char tramaICMP[2];
		unsigned char * chekifin;
		unsigned char TIP[10];
		int e;
		unsigned char tcpof=0, IHL=0, longitud=0,  val_inicio=0, tipo=0, inicio=0, codigo=0;
		printf("\n+++++++++++++++ Cabecera ETHERNET +++++++++++++++\n");
			printf("\n");
		printf("Mac Destino: %.2x:%.2x:%.2x:%.2x:%.2x:%.2x\n", T[0], T[1], T[2], T[3], T[4], T[5] );  //DESTINO
		printf("Mac Origen: %.2x:%.2x:%.2x:%.2x:%.2x:%.2x \n", T[6], T[7], T[8], T[9], T[10], T[11]); //ORIGEN	
	if (((T[12]&255)<<8) + (T[13]&255) <= 1500) /////////////PROTOCOLO LLC
	{
	printf("Tamanio en bytes: ", ((T[12]&255)<<8) + (T[13]&255));	
	switch (T[16] & 3)
	{
		case 0: case 2:
		if (e = 1) //EXTENDIDA
			printf("T-I, N(s)= %d, N(r) = %d\n", T[16]>>1, T[17]>>1);
		else      //
			printf("T-I, N(s)= %d, N(r) = %d\n", (T[16]>>1)&7, T[16]>>5);
		case 1:  //INFORMACIÓN
		if (e = 0)
			printf("T-S %s, N(r) = %d\n", supervision[(T[16]>>2)&3], T[16]>>5);
		else    
			printf("T-S %s, N(r) = %d\n", supervision[(T[16]>>2)&3], T[17]>>1);
		case 3:  //NO NUMERADA
		if (T[16] & 16)
			if(T[15] & 1)
				printf("T-U, %s, f\n", UR[((T[16]>>2)&3) + ((T[16]>>3)&28)]);
			else
				printf("T-U, %s, p\n", UC[((T[16]>>2)&3) + ((T[16]>>3)&28)]);
			
 }
	} 
	else if (( (T[12]&255)<<8) + (T[13]&255)  == 2048) //PROTOCOLO IP
	{
			printf("\n+++++++++++++++ Cabecera IP +++++++++++++++\n");
				printf("\n");
				printf("Version: ");
				if(((T[14]>>4)&15)== 4){
					printf("4\n");
				}
    

			IHL=(T[14]&15)*4; //IHL (INTERNET HEADER LENGHT) 20 BYTES

				printf("Tamano de cabecera: %d bytes\n", IHL);
				printf("Tipo de servicio: \n");
				if((T[15]&16)== 16){
					printf("Retardo minimo\n");
				}
				if((T[15]&8)==8){
					printf(" Rendimiento maximo\n");
				}
				if((T[15]&4)==4){
					printf("Confiabilidad maxima\n");
				}
				if((T[15]&4)==2){
					printf("Costo minimo\n");
				}
			longitud=((T[16]<<8)+T[17]);
				printf("Longitud total: %i\n",longitud);
				printf("Identificador: %d\n",(T[18]<<8)+T[19]);
				printf("Banderas: ");
				if((T[20]&64)){
					printf("Dont fragment\n");
				}else{
					printf("Fragment\n");
					printf("Offset: %d\n",(((T[20]&31)<<8)+T[21]));
					printf("TTLL: %d\n",T[22]);
					printf("Protocolo:");
				}
				if((T[20]&32)){
					printf("More Fragment\n");
				}else{
					printf("Last fragment\n");
				}

				if(T[23]==1){
					printf("ICMP\n");
				}
				if(T[23]==2){
					printf("IGMP\n");
				}
				if(T[23]==6){
					printf("TCP\n");
				}
				if(T[23]==9){
					printf("IGRP\n");
				}
				if(T[23]==17){
					printf("UDP\n");
				}
				if(T[23]==47){
					printf("GRE\n");
				}
				if(T[23]==50){
					printf("ESP\n");
				}
				if(T[23]==51){
					printf("AH\n");
				}
				if(T[23]==57){
					printf("SKIP\n");
				}
				if(T[23]==88){
					printf("EIGRP\n");
				}
				if(T[23]==89){
					printf("OSPF\n");

				}
				if(T[23]==115){
					printf("L2TP\n");
				}
		//HEADER CHECKSUM

		printf(" Checksum: %.2X%.2X \n",T[24],T[25]);
			int i=0;
				for(i=0;i<10;i++){
					TIP[i]=T[i+14];
				}
			//	chekifin=check(T, 14, val_inicio - 1, 0);
				val_inicio = (14+IHL);
				printf(" ChekFinal: %s\n ",check(T, 14, val_inicio - 1, 0));

		printf("IP origen: %d.%d.%d.%d\n",T[26],T[27],T[28],T[29]);
		printf("IP destino: %d.%d.%d.%d\n",T[30],T[31],T[32],T[33]);
		if(IHL>20){
			if(IHL%4==0){ //Residuo con 4 para entrar al if
				printf(" Opciones: \n ");
				int i=0;
				for(i=0;i<IHL-20;i++){
					printf("%.2X ",T[i+34]);
				}
			}			
		}else{
			printf("It hasnt options bro\n");
		}


		//CABECERA ICMP 
		
		val_inicio= 14+IHL;
		if(T[23]==1){ //CABECERA ICMP
					printf("\n+++++++++++++++ Cabecera ICMP +++++++++++++++\n");
					printf("\n");
					tipo=T[val_inicio];
					codigo=T[val_inicio+1];
						switch(tipo){
							case 0: //CASO 0 GENERAL 
								printf("Type: 0 Echo reply");
							break;
							case 3:  //CASO 3 GENERAL 
								printf("Type: 3 Destination unreachable");
									switch(codigo){
										case 0:
											printf("Codigo: 0 Net unreachable");
									    break;
										case 1:
											printf("Codigo: 1 Host unreachable");
											break;
										case 2:
											printf("Codigo: 2 Protocol unreachable");
										break;						
										case 3:
											printf("Codigo: 3 Port unreachable");
										break;
										case 4:
											printf("Codigo: 4 Fragmentation needed & DF set");
										break;
										case 5:
											printf("Codigo: 5 Source route failed");
									    break;
										case 6:
											printf("Codigo: 6 Destinarion network unknown");
									    break;
										case 7:
											printf("Codigo: 7 Destination host unknown");
									    break;
										case 8:
											printf("Codigo: 8 Source host isolated");
									    break;
										case 9:
											printf("Codigo: 9 Network administratively prohibited");
									    break;
										case 10:
											printf("Codigo: 10 Host administratively prohibited");
									    break;
										case 11:
											printf("Codigo: 11 Network unreach for TOS");
									    break;
										case 12:
									        printf("Codigo: 12 Host Unreach for TOS");
									    break;
										case 13:
											printf("Codigo: 13 Comunication administratively prohibited");
									    break;
									}
							

							break;
							case 4:  //CASO 4 GENERAL 
								printf("Type: 4 Source quench");
							break;
							case 5:  //CASO 5 GENERAL 
								printf("Type: 5 Redirect");
								switch(codigo)
								{
									case 0: 
										printf("Datagram for the Network\n");
									break;
									case 1:
										printf("Datagram for the Host\n");
									break;
									case 2:
										printf("Datagram for the TOS & Network\n");
									break;
									case 3:
										printf("Datagram for the TOS & Host\n");
									break;
									
								}
							break;
							case 8:  //CASO 8 GENERAL
								printf("Type: 8 Echo");
							break;
							case 9:  //CASO 9 GENERAL
								printf("Type: 9 Router advertisement");
							break;
							case 10: //CASO 10 GENERAL
								printf("Type: 10 Router selection");
							break;
							case 11:  //CASO 11 GENERAL
								printf("Type: 11 Time exceeded");
								switch(codigo)
								{
									case 0: 
										printf("Time to Live exceded in Transist\n");
									break;
									case 1:
										printf("Fragment Reassembly time exceeded\n");
									break;
								}
							break;
							case 12: //CASO 12 GENERAL
								printf("Type: 12 Parameter problem");
								{
									switch(codigo)
								{
									
									case 0: 
										printf("Pointer indicates the error\n");
									break;
									case 1:
										printf("Missing a required option\n");
									break;
									case 2:
										printf("Bad Lenght\n");
									break;
								}
								}
							break;												
							case 13:
								printf("Type: 13 Timestamp");
							break;
							case 14:
								printf("Type: 14 Timestamp reply");
							break;
							case 15:
								printf("Type: 15 Information request");
							break;
							case 16:
								printf("Type: 16 Informacion reply");
							break;
							case 17:
								printf("Type: 17 Address mask request");
							break;
							case 18:
								printf("Type: 18 Address mask reply");
							break;
							case 30:
								printf("Type: 30 Traceroute");
							break;
						}
						printf("Checksum de Trama: %.2X%.2X\n",T[val_inicio+2],T[val_inicio+3]);
						chekifin = check(T, val_inicio, val_inicio + 3, 1);
						printf("Checksum: %s\n", chekifin);
					printf("Checksum Calculado: %.2X\n", chekifin);
					printf("Otra informacion: %.2X %.2X %.2X %.2X\n",T[val_inicio+4],T[val_inicio+5],T[val_inicio+6],T[val_inicio+7]);

				} 

			if (T[23] == 6)  //-----------------TCP------------
		{
			unsigned char chkTCP[12];
			printf("\n+++++++++++++++ CABECERA TCP +++++++++++++++\n");
				printf("\n");
			printf("Puerto Origen: %d\n", (T[val_inicio]<<8) | T[val_inicio + 1]);
			switch((T[val_inicio]>>8) | T[val_inicio + 1])
			{
				case 7:
					printf(" Echo");
					break;
				case 19:
					printf(" Chargen");
					break;
				case 20:
					printf(" FTP-data");
					break;
				case 21:
					printf(" FTP-control");
					break;
				case 22:
					printf(" SSH");
					break;
				case 23:
					printf(" Telnet");
					break;
				case 25:
					printf(" SMTP");
					break;
				case 53:
					printf(" Domain");
					break;
				case 79:
					printf(" Finger");
					break;
				case 80:
					printf(" HTTP");
					break;
				case 110:
					printf(" POP3");
					break;
				case 111:
					printf(" SUNRPC");
					break;
				case 119:
					printf(" NNTP");
					break;
				case 139:
					printf(" Netbios-ssn");
					break;
				case 143:
					printf(" IMAP");
					break;
				case 179:
					printf(" BGP");
					break;
				case 389:
					printf(" LDAP");
					break;
				case 443:
					printf(" HTPPS (SSL)");
					break;
				case 445:
					printf(" Microsoft-DS");
					break;
				case 1080:
					printf(" Socks");
					break;
			}
			printf("Puerto Destino: %d\n", (T[val_inicio + 2]<<8) | T[val_inicio + 3]);
			switch((T[val_inicio + 2]>>8) | T[val_inicio + 3])
			{
				case 7:
					printf(" Echo");
					break;
				case 19:
					printf(" Chargen");
					break;
				case 20:
					printf(" FTP-data");
					break;
				case 21:
					printf(" FTP-control");
					break;
				case 22:
					printf(" SSH");
					break;
				case 23:
					printf(" Telnet");
					break;
				case 25:
					printf(" SMTP");
					break;
				case 53:
					printf(" Domain");
					break;
				case 79:
					printf("Finger");
					break;
				case 80:
					printf("HTTP");
					break;
				case 110:
					printf("POP3");
					break;
				case 111:
					printf("SUNRPC");
					break;
				case 119:
					printf("NNTP");
					break;
				case 139:
					printf("Netbios-ssn");
					break;
				case 143:
					printf("IMAP");
					break;
				case 179:
					printf("BGP");
					break;
				case 389:
					printf("LDAP");
					break;
				case 443:
					printf("HTPPS (SSL)");
					break;
				case 445:
					printf("Microsoft-DS");
					break;
				case 1080:
					printf("Socks");
					break;
			}
			unsigned char campos;
			printf("\nOffset: %d\n", (T[26 + IHL]>>4)*4);
			printf("Banderas: \n");
			if (T[27]&32) printf("Consulta Urgente\n");
			if (T[27]&16) printf("Acuse de Recibo\n");
			if (T[27]&8) printf("Push\n");
			if (T[27]&4) printf("Reseteo de Conexion\n");
			if (T[27]&2) printf("Sincronizacion de los Numeros de Secuencia\n");
			if (T[27]&1) printf("Fin de la Conexion\n");
			printf("Ventana: %d bytes\n", (T[28]>>8) | T[29]);
			printf("Header Checksum: %.2x%.2x\n", T[31], T[32]);
			for(i = 0; i < 12; i++) chkTCP[i] = T[val_inicio + i];
			campos = (T[26 + IHL] >> 4) << 2;
			chekifin = check(T, val_inicio, val_inicio + campos - 1, 1);
			printf("Checksum: %s\n", chekifin);
			printf("Puntero de urgencia: %d\n", ((T[32]>>8) | T[33])*4);
			if (((T[26 + IHL]>>4)*4) > 20)
			{
				printf("Opciones: \n");
				for (i = 34 + IHL; i < (34 + IHL) + ((T[26 + IHL]>>4)*4) - 20; i++)
				{
			
					printf("%d\n", T[i]);
				}
			}
			else printf("Sin opciones\n");
		}
			
				if(T[23] == 17) //  UDP  
		{
			unsigned char chkUDP[6];
			printf("\n+++++++++++++++ Cabecera UDP +++++++++++++++\n");
				printf("\n");
			printf("Puerto Origen: %d\n", (T[val_inicio]<<8) | T[val_inicio + 1]);
			switch((T[val_inicio]>>8) | T[val_inicio + 1])
			{
				case 7:
					printf("Echo\n");
					break;
				case 19:
					printf("Chargen\n");
					break;
				case 37:
					printf("Time\n");
					break;
				case 53:
					printf("Domain\n");
					break;
				case 67:
					printf("Bootps (DHCP)\n");
					break;
				case 68:
					printf("Bootpc (DHCP)\n");
					break;
				case 69:
					printf("TFTP\n");
					break;
				case 137:
					printf("Netbios-ns\n");
					break;
				case 138:
					printf("Netbios-dgm\n");
					break;
				case 151:
					printf("SNMP\n");
					break;
				case 162:
					printf("SNMP-TRAP\n");
					break;
				case 500:
					printf("ISSKMP\n");
					break;
				case 514:
					printf("SYSLOG\n");
					break;
				case 520:
					printf("RIP\n");
					break;
				case 33434:
					printf("Traceroute\n");
					break;
			}
			printf("Puerto Destino: %d\n", (T[val_inicio + 2]<<8) | T[val_inicio + 3]);
			switch((T[val_inicio + 2]>>8) | T[val_inicio + 3])
			{
				case 7:
					printf("Echo\n");
					break;
				case 19:
					printf("Chargen\n");
					break;
				case 37:
					printf("Time\n");
					break;
				case 53:
					printf("Domain\n");
					break;
				case 67:
					printf("Bootps (DHCP)\n");
					break;
				case 68:
					printf("Bootpc (DHCP)\n");
					break;
				case 69:
					printf("TFTP\n");
					break;
				case 137:
					printf("Netbios-ns\n");
					break;
				case 138:
					printf("Netbios-dgm\n");
					break;
				case 151:
					printf("SNMP\n");
					break;
				case 162:
					printf("SNMP-TRAP\n");
					break;
				case 500:
					printf("ISSKMP\n");
					break;
				case 514:
					printf("SYSLOG\n");
					break;
				case 520:
					printf("RIP\n");
					break;
				case 33434:
					printf("Traceroute\n");
					break;
			}
			unsigned char campos;
			printf("Longitud: %d bytes\n", (T[18]<<8) | T[19]);
			printf("Header Checksum: %.2x%.2x\n", T[val_inicio + 6], T[val_inicio + 7]);
			int i=0;
			for (i = 0; i < 6; i++) chkUDP[i] = T[val_inicio + i];
			campos = ((T[18 + IHL] << 8) | T[19 + IHL]);
			chekifin = check(T, val_inicio, val_inicio + campos - 1, 1);
			printf("Checksum: %s\n", chekifin);
		}
		printf("\n");
	


	}
	else if ((  (T[12]&255)<<8) + (T[13]&255)  == 2054)
	{
		printf("++++++++++++++PROTOCOLO ARP+++++++++++++\n");
		printf("\n");
		if (((T[14]&255)<<8) + (T[15]&255) == 1) printf("Tipo de direccion de HARDWARE: ETHERNET\n");
		else if (((T[14]&255)<<8) + (T[15]&255) == 6) printf("Tipo de direccion de HARDWARE: IEEE 802 LAN TOKEN RING\n");
		else if (((T[14]&255)<<8) + (T[15]&255) == 15) printf("Tipo de direccion de HARDWARE: FRAME RELAY\n");
		else if (((T[14]&255)<<8) + (T[15]&255) == 16) printf("Tipo de direccion de HARDWARE: ATM\n");
		if (((T[16]&255)<<8) + (T[17]&255) == 2048) printf("Tipo de PROTOCOLO: IP\n");
		printf("Tamanio de direccion de hardware: %d\n", T[18]);
		printf("Tamanio de direccioon de protocolo: %d\n", T[19]);
		if(((T[20]&255)<<8)+ (T[21]&255)== 1) printf ("SOLICITUD ARP\n");
		else if(((T[20]&255)<<8)+ (T[21]&255)== 2) printf ("RESPUESTA ARP\n");
		else if(((T[20]&255)<<8)+ (T[21]&255)== 8) printf ("SOLICITUD INVERSA ARP\n");
		else if(((T[20]&255)<<8)+ (T[21]&255)== 9) printf ("RESPUESTA INVERSA ARP\n");
		printf("Mac Origen de ARP: %.2x:%.2x:%.2x:%.2x:%.2x:%.2x\n", T[22], T[23], T[24], T[25], T[26], T[27]);
		printf("Protocolo origen: %.2x:%.2x:%.2x:%.2x:%.2x:%.2x\n", T[28], T[29], T[30], T[31]);
		printf("Mac DEstino de ARP: %.2x:%.2x:%.2x:%.2x:%.2x:%.2x\n", T[32], T[33], T[34], T[35], T[36], T[37]);
		printf("Protocolo Destino: %.2x:%.2x:%.2x:%.2x:%.2x:%.2x\n", T[38], T[39], T[40], T[41]);
	}
	else 
	
	{
		printf("Otro, compa");
	}	
		
		
}

char * check(unsigned char *T, unsigned char inicio, unsigned char final, unsigned char protocolo)
{
	unsigned int sum = 0, pseudo = 0;	
	unsigned char i;
	if ((final - inicio + 1) % 2)
	{
		for (i = inicio; i < final - 1; i += 2)
			sum += ((T[i] << 8) + T[i + 1]);
		sum += T[final];
	}
	else
		for (i = inicio; i < final; i += 2)
			sum += ((T[i] << 8) + T[i + 1]);
	
	if (protocolo)
	{
		for (i = 26; i < 33; i += 2)
			pseudo += ((T[i] << 8) + T[i + 1]);
		if ((T[23] ^ 17))
		{
			if ((T[23] ^ 6))
			{
				if ((T[23] ^ 1)){}
				else
					sum = sum;
			}
			else
				sum += (pseudo + ((T[inicio + 12] >> 4) << 2) + T[23]);
		}
		else
			sum += (pseudo + ((T[inicio + 4] << 8) + T[inicio + 5]) + T[23]);
	}
	return (((unsigned short)sum + (sum >> 16)) ^ 0xffff) ? "Trama Invalida" : "Trama Valida\t";
}


